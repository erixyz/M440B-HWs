---
title: "M440B HW 18"
author: "Erick Castillo"
date: "5/11/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
doggo <- read.csv("~/M440B_HW/M440B Stuff/Data/dogsstacked.csv")
```

\textbf{Problem 26.} This question uses the "dogsstacked" csv file available on Canvas. The question asks if there is a different in the treatment effects. It asks to solve by using both a parametric and nonparametric analysis.
```{r, out.width = '50%', out.height = '50%'}
aovmod1 <- aov(concentration~factor(dog) + factor(drug), data = doggo)
summary(aovmod1)
qqnorm(resid(aovmod1))
```

Beginning with the parametric AOV output, we can see that the p-values for the dog category is huge at 0.8772 while the drug category is at 0.0277. Looking at just these numbers alone indicates that the mean difference of epinephrine in dogs is about the same across the 10 dogs used in the study. There appears to be some evidence that at least one of the drugs tested had a significant difference in the mean from the other drugs.\
\
The Q-Q plot indicates that the residuals generated by this model appear to fall in line with the normal distribution. Notice that the tails of the residual's distribution do appear to be lighter on both ends.\
\
The following code runs a nonparametric analysis of the data.
```{r}
friedman.test(concentration ~ drug | dog, data = doggo)
```

In this case the null hypothesis $H_0$ states that the epinephrine measurements remain consistent across the groups. With a p-value of 0.4966 we fail to reject $H_0$. The results of the parametric and non-parametric analysis are consistent with each other because the parametric analysis shows that the difference in epinephrine is not significantly different among dogs given drugs are taken into account.\
\
The following code will check for interactions in the data.
```{r, out.width = '70%', out.height = '70%'}
with(doggo,interaction.plot(dog,drug,concentration))
```

The above output indicates very strongly that interactions are present in the data. Notice how the plots overlap with each other at different points and that the plots have similar shapes. There appears to be a multiplicative effect that's not being taken into account.\
\
\textbf{Problem 34.}\
\
(i.) This problem uses the "poisonstacked" csv on Canvas. The first part of this question asks to use a two-way AOV.
```{r}
pois <- read.csv("~/M440B_HW/M440B Stuff/Data/poisonsstacked.CSV")
aovmod2 <- aov(SurvTime~factor(Poison)*factor(Treatment), data = pois)
summary(aovmod2)
```

The final p-value indicates that there is weak evidence of a multiplicative effect present in the data. The F-values $>>1$ show that there is strong evidence that a difference in means is present when observing the data from the poison and treatment perspective. That is, different poisons and different treatment produce differing results in the survival times of the poisoned animals.\
\
(ii.) Because the interaction is not significant at $\alpha = 0.5$ I will now run an additive effect model.
```{r}
aovmod3 <- aov(SurvTime~factor(Poison) + factor(Treatment), data = pois)
summary(aovmod3)
```

Notice that these p-values are similar to the ones calculated prior. Conclusions made from the prior multiplicative table can be applied to this table.\
\
(iii.) The following code applies a transformation to the data:
```{r}
aovmod4 <- aov(1/SurvTime ~ factor(Poison) + factor(Treatment), data = pois)
summary(aovmod4)
```

The transformation increased the F-statistics for the poison and treatment categories. The interaction term is still as insignificant as it was in the original AOV model.\
\
The following are the plots of the response variable and the transformed response variable. Notice the transformation was necessary to get accurate results.
```{r, out.width = '50%', out.height = '50%', echo = FALSE}
with(pois,interaction.plot(Poison,Treatment,SurvTime))
with(pois,interaction.plot(Poison,Treatment,1/SurvTime))
```
